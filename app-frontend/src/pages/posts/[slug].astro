---
import type { InferGetStaticPropsType } from 'astro';
import type { Post } from 'app-payload';
import { getCollection } from 'astro:content';
import PostRenderer from '../../components/PostRenderer.astro';

export async function getStaticPaths() {
  const allPosts = await getCollection('posts');

  return allPosts.map(({ data }) => {
    const post = data as Post;
    return {
      params: { slug: post.slug },
      props: { post },
    };
  });
}

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { post } = Astro.props as { post: Post };
---

<PostRenderer {post} />
