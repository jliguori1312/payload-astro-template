---
import type { Page } from 'app-payload';
import { getCollection } from 'astro:content';
import PageRenderer from '../components/PageRenderer.astro';

export async function getStaticPaths() {
  const allPages = await getCollection('pages');

  return allPages.map(({ data }) => {
    const page = data as Page;
    if (page.slug === 'home')
      return {
        params: { slug: undefined },
        props: { page },
      };
    return {
      params: { slug: page.slug },
      props: { page },
    };
  });
}

const { page } = Astro.props as { page: Page };
---

<PageRenderer {page} />
